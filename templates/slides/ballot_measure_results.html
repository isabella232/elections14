<div class="results-wrapper hide-results {{ page_class }}">
    <div class="results-inner results-container">
        <div class="results-header">
            <h1>{{ page_title }}</h1>
        </div>

        <div class="results">
            {% for closing_time, races in poll_groups %}
            <h2 class="poll-closing-group"><span class="time">{{ closing_time|format_board_time }}</span></h2>

            <table class="races">
                {% for race in races %}
                <tr class="race dontsplit">
                    <td class="results-status{% if race.is_called() %} called{% elif race.is_reporting() %} reporting{% endif %}">
                        {% if race.is_called() %}
                            {{ race.precincts_reporting_percent()|format_percent }}
                        {% elif race.is_reporting() %}
                            {{ race.precincts_reporting_percent()|format_percent }}
                        {% else %}
                            &mdash;
                        {% endif %}
                    </td>
                    <td class="state{% if race.is_called() %} {{ race.get_winning_party() }}{% else %} {{ race.previous_party }}{% endif %} ">
                        {{ race.state_postal }}{% if seat_number %}<span class="seat_number">-{{ race.seat_number }}</span>
                        {% endif %}
                    </td>
                    <td class="description">
                        {{ race.ballot_measure_description }}
                    </td>
                    {% set candidate = race.top_choices()[0] %}
                    <td class="choice id-{{ candidate.candidate_id }}{% if candidate.is_winner() %} winner{% endif %}"><span class="lname">{{ candidate.last_name }}</span></td>
                    <td class="candidate-total {{ candidate.party|lower }}{% if candidate.is_winner() %} winner{% endif %}{% if race.is_reporting() %} reporting{% endif %}">{% if race.is_reporting() %}{{ candidate.vote_percent()|format_percent }}{% else %}--{% endif %}</td>
                    {% set candidate = race.top_choices()[1] %}
                    <td class="candidate-total {{ candidate.party|lower }}{% if candidate.is_winner() %} winner{% endif %}{% if candidate.incumbent %} incumbent{% endif %}{% if race.is_reporting() %} reporting{% endif %}">{% if race.is_reporting() %}{{ candidate.vote_percent()|format_percent }}{% else %}--{% endif %}</td>
                    <td class="choice id-{{ candidate.candidate_id }}{% if candidate.is_winner() %} winner{% endif %}"><span class="lname">{{ candidate.last_name }}</span></td>
                </tr>
                {% endfor %}
            </table>
            {% endfor %}
        </div>
    </div>
</div>

<script>
var colOpts = {
  precise: true,
  columns: {{ column_number }},
}

// Columnizer needs a short pause or else it acts strangely on subsequent calls
setTimeout(function() {
  $('.results').columnize(colOpts);
  $('.results-wrapper').animate({ 'opacity': 1 }, 500, function() {
    $(this).removeClass('hide-results');
  });
}, 100);

</script>
